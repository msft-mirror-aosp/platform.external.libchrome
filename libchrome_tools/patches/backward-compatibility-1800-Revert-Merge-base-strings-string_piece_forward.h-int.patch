From 043edde47e38fc1959a4303364b71c5b8ab7969d Mon Sep 17 00:00:00 2001
From: Ryo Hashimoto <hashimoto@chromium.org>
Date: Wed, 15 Nov 2023 19:35:45 +0900
Subject: [PATCH] Revert "Merge base/strings/string_piece_forward.h into
 string_piece.h"

This reverts commit 0aecac68e63f39bc04bab6417f0638676ff07732.

Change-Id: Iae63384b06d5c8d965359ef9a30a31717c3fe226
---
 base/logging.h                      |  2 +-
 base/strings/string_piece.h         | 13 +++----------
 base/strings/string_piece_forward.h | 25 +++++++++++++++++++++++++
 3 files changed, 29 insertions(+), 11 deletions(-)
 create mode 100644 base/strings/string_piece_forward.h

diff --git a/base/logging.h b/base/logging.h
index 04b915cde2..7e75485b9b 100644
--- a/base/logging.h
+++ b/base/logging.h
@@ -18,7 +18,7 @@
 #include "base/dcheck_is_on.h"
 #include "base/functional/callback_forward.h"
 #include "base/scoped_clear_last_error.h"
-#include "base/strings/string_piece.h"
+#include "base/strings/string_piece_forward.h"
 #include "base/strings/utf_ostream_operators.h"
 #include "build/build_config.h"
 #include "build/chromeos_buildflags.h"
diff --git a/base/strings/string_piece.h b/base/strings/string_piece.h
index 13bccd9eaf..fa421ddcc4 100644
--- a/base/strings/string_piece.h
+++ b/base/strings/string_piece.h
@@ -10,15 +10,8 @@
 #ifndef BASE_STRINGS_STRING_PIECE_H_
 #define BASE_STRINGS_STRING_PIECE_H_
 
-#include <string_view>
-
-namespace base {
-
-template <typename CharT, typename Traits = std::char_traits<CharT>>
-using BasicStringPiece = std::basic_string_view<CharT, Traits>;
-using StringPiece = std::string_view;
-using StringPiece16 = std::u16string_view;
-
-}  // namespace base
+#include "base/check.h"
+#include "base/check_op.h"
+#include "base/strings/string_piece_forward.h"
 
 #endif  // BASE_STRINGS_STRING_PIECE_H_
diff --git a/base/strings/string_piece_forward.h b/base/strings/string_piece_forward.h
new file mode 100644
index 0000000000..e471b4cb8b
--- /dev/null
+++ b/base/strings/string_piece_forward.h
@@ -0,0 +1,25 @@
+// Copyright 2017 The Chromium Authors
+// Use of this source code is governed by a BSD-style license that can be
+// found in the LICENSE file.
+//
+// This header is deprecated. `base::StringPiece` is now `std::string_view`.
+// Use it and <string_view> instead.
+//
+// TODO(crbug.com/691162): Remove uses of this header.
+
+#ifndef BASE_STRINGS_STRING_PIECE_FORWARD_H_
+#define BASE_STRINGS_STRING_PIECE_FORWARD_H_
+
+#include <string_view>
+
+namespace base {
+
+template <typename CharT, typename Traits = std::char_traits<CharT>>
+using BasicStringPiece = std::basic_string_view<CharT, Traits>;
+using StringPiece = std::string_view;
+using StringPiece16 = std::u16string_view;
+using WStringPiece = std::wstring_view;
+
+}  // namespace base
+
+#endif  // BASE_STRINGS_STRING_PIECE_FORWARD_H_
-- 
2.43.0.rc0.421.g78406f8d94-goog

