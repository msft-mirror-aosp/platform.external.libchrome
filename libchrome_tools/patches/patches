# This file will be used by emerge in libchrome-XXXX.ebuild to determine the
# order of applying patches.
#
# Support selectively applying patch by use flag, examples:
# * To apply foo.patch to every board, add
#   `foo.patch`
# * To apply foo.patch to board bar only, add
#   `foo.patch board_use_bar`
# * To apply foo.patch to board installing package baz only, add
#   `foo.patch board_use_baz`
# Note: add flag to IUSE in libchrome ebuild if it is not already there.

# ========= LONG TERM PATCHES =========================

# Remove glib dependency.
# TODO(hidehiko): Fix the config in AOSP libchrome.
libchrome-Remove-glib-dependency.patch

# Refer to crbug/1093642 on upstream or abandon these two patches.
# Add MockObjectManager, which is removed upstream.
add-mock-object-manager.patch

# Solve name conflict with abseil in absl package, when a program in Chromium
# OS depends on both abseil and libchrome.
absl-thread-annotation-conflict.patch

# Diagnostic code for upsteram to investigate crbug/1001171.
# We don't need.
revert-crbug-1001171.patch

# libchrome does not support boringssl.
keep-hash-sha1-old-implementation.patch

# libchrome does not support trace_event
# Compatmentalize patches to reduce chance of failing to apply them.
disable-trace_event-in-base.patch
disable-trace_event-in-components.patch
disable-trace_event-in-mojo-core-code.patch
disable-trace_event-in-mojo-public.patch
disable-trace_event-in-ipc.patch

# ==================== CHERRY PICKS ===========================
# Modify mojom_parser.py to search for external Mojo modules.
# Remove after r900163
mojom-parser-external-modules.patch

# Remove after r910765
jinja2-update-to-2.10.1.patch

# Remove after r912107
mojo-Add-ReceiverSetBase-RemoveWithReason.patch

# ==================== BACKWARD / FORWARD COMPATIBILITY PATCHES FOR UPREVS ===
# TODO(b/192529039): Remove when all base::Optional usages are migrated to
# std::optional
backward-compatibility-Add-base-Optional-as-alias-of-absl-optional.patch

# Backward compatibility patch to add support of SimpleAlarmTimer
# TODO(b/196308068): remove after usages in shill and power_manger are removed
backward-compatibility-add-SimpleAlarmTimer.patch

# Backward compatibility for r890000 uprev
# Adds base::Callback, base::Bind, etc as there are still many usages in CrOS
# TODO(crbug.com/1205291): remove when they are all migrated to Once/Repeating
# variants
backward-compatibility-add-deprecated-base-Bind-APIs.patch

# Backward compatibility patch to temporarily disable KernelVersionNumbers
# since it introduces new syscall uname.
# TODO(b/202361491): Remove the patch when tested thoroughly.
backward-compatibility-disable-KernelVersionNumbers.patch

# Backward compatibility patch to temporarily disable CopyFileContentsWithSendfile
# since it introduces new syscall sendfile.
# TODO(b/202686177): Remove the patch when tested thoroughly.
backward-compatibility-disable-CopyFileContentsWithSendfile.patch

# Backward compatibility patch to temporarily add base::AdaptCallbackForRepeating
# TODO(b/204383858): Remove the patch when usage in mri_package is removed
backward-compatibility-add-base-AdaptCallbackForRepaeting.patch board_use_endeavour

# Backward compatibility patches for mistral board only
# TODO(b/206056111): Remove when they accepts changes or mistral is not using
# main branch or mistral is not on libchrome CQ
# Backward compatibility patch to add base/logging.h for webserver
Include-base-logging.h-for-webserver-on-mistral.patch board_use_mistral
# Backward compatibility patch to add base/scoped_observer.h for ap-daemons
backward-compatibility-add-base-ScopedObserver-for-mistral.patch board_use_mistral
