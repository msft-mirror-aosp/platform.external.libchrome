From dfb808bf1e8a496f00a4bd90999fb22659645801 Mon Sep 17 00:00:00 2001
From: Grace Cham <hscham@chromium.org>
Date: Wed, 15 Jun 2022 21:59:29 +0900
Subject: [PATCH] disable SharedMemoryTracker

---
 base/memory/shared_memory_mapping.cc | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

diff --git a/base/memory/shared_memory_mapping.cc b/base/memory/shared_memory_mapping.cc
index 82c03f3ec371..19092acc7f9a 100644
--- a/base/memory/shared_memory_mapping.cc
+++ b/base/memory/shared_memory_mapping.cc
@@ -10,7 +10,8 @@
 #include "base/bits.h"
 #include "base/logging.h"
 #include "base/memory/shared_memory_security_policy.h"
-#include "base/memory/shared_memory_tracker.h"
+// Unsupported in libchrome
+// #include "base/memory/shared_memory_tracker.h"
 #include "base/system/sys_info.h"
 #include "base/unguessable_token.h"
 #include "build/build_config.h"
@@ -45,7 +46,7 @@ SharedMemoryMapping::SharedMemoryMapping(span<uint8_t> mapped_span,
                                          SharedMemoryMapper* mapper)
     : mapped_span_(mapped_span), size_(size), guid_(guid), mapper_(mapper) {
   // Note: except on Windows, `mapped_span_.size() == size_`.
-  SharedMemoryTracker::GetInstance()->IncrementMemoryUsage(*this);
+  // SharedMemoryTracker::GetInstance()->IncrementMemoryUsage(*this);
 }
 
 void SharedMemoryMapping::Unmap() {
@@ -53,7 +54,7 @@ void SharedMemoryMapping::Unmap() {
     return;
 
   SharedMemorySecurityPolicy::ReleaseReservationForMapping(size_);
-  SharedMemoryTracker::GetInstance()->DecrementMemoryUsage(*this);
+  // SharedMemoryTracker::GetInstance()->DecrementMemoryUsage(*this);
 
   SharedMemoryMapper* mapper = mapper_;
   if (!mapper)
-- 
2.37.1.359.gd136c6c3e2-goog

